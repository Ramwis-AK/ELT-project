//LOAD DIMENSIONS//
CREATE OR REPLACE TABLE ANALYTICS.DIM_ACCOUNT AS SELECT DISTINCT 
    ACCOUNT_ID, 
    ACCOUNT_NAME, 
    'USA' AS country, 
    CURRENT_DATE AS created_date 
FROM RAW.STG_FB_ADS_DEDUPLICATED 
WHERE ACCOUNT_ID IS NOT NULL;

SELECT * FROM ANALYTICS.DIM_ACCOUNT;

CREATE OR REPLACE TABLE ANALYTICS.DIM_ADSET AS SELECT DISTINCT 
    ADSET_ID,
    ADSET_NAME,
    CAMPAIGN_ID,
    'ACTIVE' AS status,
    CURRENT_DATE AS created_date
FROM RAW.STG_FB_ADS_DEDUPLICATED
WHERE ADSET_ID IS NOT NULL;

SELECT COUNT(*) FROM ANALYTICS.DIM_ADSET;
